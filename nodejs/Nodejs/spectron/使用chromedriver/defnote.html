<html><head></head>
<body><div>这种模式下是将electron程序当做一个浏览器使用, 通过driver来访问不同的url 或者直接查找访问不同的元素, 但是这个方式有一个小问题在于因为没有右键-查看元素, 所以在查找元素的时候并不方便, 还显得比较繁琐</div><div><br></div><div><br></div><div>首先手动执行chromedriver.exe</div><div><!--StartFragment--><meta http-equiv="content-type" content="text/html; charset=UTF-8"><pre style="background-color:#ffffff;color:#000000;font-family:'宋体';font-size:9.0pt;"><span style="color:#000080;font-weight:bold;">const </span><span style="color:#458383;">webdriver </span>= <span style="color:#660e7a;font-weight:bold;font-style:italic;">require</span>(<span style="color:#008000;font-weight:bold;">'selenium-webdriver'</span>);</pre><pre style="background-color: rgb(255, 255, 255); font-family: 宋体; font-size: 9pt; "><!--StartFragment--><meta http-equiv="content-type" content="text/html; charset=UTF-8"><pre style="background-color: rgb(255, 255, 255); font-family: 宋体; font-size: 9pt; "><span style="color: rgb(0, 0, 128); font-weight: bold; ">var </span><span style="color: rgb(69, 131, 131); ">driver </span>= <span style="color: rgb(0, 0, 128); font-weight: bold; ">new </span><span style="color: rgb(69, 131, 131); ">webdriver</span>.Builder()<br><span style="color: rgb(128, 128, 128); font-style: italic; ">// "9515" 是ChromeDriver使用的端口<br></span><span style="color: rgb(128, 128, 128); font-style: italic; ">    </span>.usingServer(<span style="color: rgb(0, 128, 0); font-weight: bold; ">'http://localhost:9515'</span>)<br>    .withCapabilities({<br>        <span style="color: rgb(102, 14, 122); font-weight: bold; ">chromeOptions</span>: {<br>            <span style="color: rgb(128, 128, 128); font-style: italic; ">// 这里设置Electron的路径<br></span><span style="color: rgb(128, 128, 128); font-style: italic; ">            </span><span style="color: rgb(102, 14, 122); font-weight: bold; ">binary</span>: <span style="color: rgb(0, 128, 0); font-weight: bold; ">'D:</span><span style="color: rgb(0, 0, 128); font-weight: bold; ">\\</span><span style="color: rgb(0, 128, 0); font-weight: bold; ">ProgramData</span><span style="color: rgb(0, 0, 128); font-weight: bold; ">\\</span><span style="color: rgb(0, 128, 0); font-weight: bold; ">npm</span><span style="color: rgb(0, 0, 128); font-weight: bold; ">\\</span><span style="color: rgb(0, 128, 0); font-weight: bold; ">node_modules</span><span style="color: rgb(0, 0, 128); font-weight: bold; ">\\</span><span style="color: rgb(0, 128, 0); font-weight: bold; ">electron</span><span style="color: rgb(0, 0, 128); font-weight: bold; ">\\</span><span style="color: rgb(0, 128, 0); font-weight: bold; ">dist</span><span style="color: rgb(0, 0, 128); font-weight: bold; ">\\</span><span style="color: rgb(0, 128, 0); font-weight: bold; ">electron.exe'</span>,<br>        }<br>    })<br>    .forBrowser(<span style="color: rgb(0, 128, 0); font-weight: bold; ">'electron'</span>)<br>    .build();<br><br><font class="Apple-style-span" color="#458383"><!--StartFragment--><meta http-equiv="content-type" content="text/html; charset=UTF-8"><pre style="background-color:#ffffff;color:#000000;font-family:'宋体';font-size:9.0pt;"><span style="color:#808080;font-style:italic;">//driver.get('http://www.google.com');<br></span><span style="color:#458383;">driver</span>.findElement(<span style="color:#458383;">webdriver</span>.By.<span style="color:#7a7a43;">id</span>(<span style="color:#008000;font-weight:bold;">"button-menus"</span>)).<span style="font-style:italic;">click</span>() <span style="color:#808080;font-style:italic;">//driver.findElement(webdriver.By.name('q')).sendKeys('webdriver');</span></pre><!--EndFragment--></font><span style="color: rgb(69, 131, 131); ">driver</span>.findElement(<span style="color: rgb(69, 131, 131); ">webdriver</span>.By.<span style="color: rgb(122, 122, 67); ">name</span>(<span style="color: rgb(0, 128, 0); font-weight: bold; ">'btnG'</span>)).<span style="color: rgb(0, 0, 0); font-style: italic; ">click</span>();<br><span style="color: rgb(69, 131, 131); ">driver</span>.<span style="color: rgb(122, 122, 67); ">wait</span>(<span style="color: rgb(0, 0, 128); font-weight: bold; ">function</span>() {<br>    <span style="color: rgb(0, 0, 128); font-weight: bold; ">return </span><span style="color: rgb(69, 131, 131); ">driver</span>.<span style="color: rgb(122, 122, 67); ">getTitle</span>().<span style="color: rgb(122, 122, 67); ">then</span>(<span style="color: rgb(0, 0, 128); font-weight: bold; ">function</span>(title) {<br>        <span style="color: rgb(0, 0, 128); font-weight: bold; ">return </span>title === <span style="color: rgb(0, 128, 0); font-weight: bold; ">'webdriver - Google Search'</span>;<br>    });<br>}, <span style="color: rgb(0, 0, 255); ">10000</span>);<br><br><span style="color: rgb(69, 131, 131); ">driver</span>.<span style="color: rgb(122, 122, 67); ">quit</span>();</pre><!--EndFragment--></pre><!--EndFragment--></div></body></html>