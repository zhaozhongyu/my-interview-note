<html><head></head>
<body><!--StartFragment--><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">作为桌面程序，当然希望能够实现操作系统的 drag &amp; drop 功能。 很多网站已经支持拖拽文件 Electron 当然也支持</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">要在 app 中实现此功能 ，你需要在 Render 进程中调用<code style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">webContents.startDrag(item)</code><span>&nbsp;</span>API， 此API会给 Main 进程发送一个<code style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">ondragstart</code>事件。</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">在 Render 进程中, 接收<span>&nbsp;</span><code style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">ondragstart</code><span>&nbsp;</span>事件并发送消息到 Main 进程。</p><div class="highlight highlight-text-html-basic" style="box-sizing: border-box; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; word-wrap: normal; padding: 16px; overflow: auto; line-height: 1.45; background-color: rgb(246, 248, 250); border-radius: 3px; word-break: normal;">&lt;<span class="pl-ent" style="box-sizing: border-box; color: rgb(34, 134, 58);">a</span> <span class="pl-e" style="box-sizing: border-box; color: rgb(111, 66, 193);">href</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">"</span>#<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">"</span></span> <span class="pl-e" style="box-sizing: border-box; color: rgb(111, 66, 193);">id</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">"</span>drag<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">"</span></span>&gt;item&lt;/<span class="pl-ent" style="box-sizing: border-box; color: rgb(34, 134, 58);">a</span>&gt;
&lt;<span class="pl-ent" style="box-sizing: border-box; color: rgb(34, 134, 58);">script</span> <span class="pl-e" style="box-sizing: border-box; color: rgb(111, 66, 193);">type</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">"</span>text/javascript<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">"</span></span> <span class="pl-e" style="box-sizing: border-box; color: rgb(111, 66, 193);">charset</span>=<span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">"</span>utf-8<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">"</span></span>&gt;<span class="pl-s1" style="box-sizing: border-box;"></span>
<span class="pl-s1" style="box-sizing: border-box;">  <span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">document</span>.<span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">getElementById</span>(<span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span>drag<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span></span>).<span class="pl-en" style="box-sizing: border-box; color: rgb(111, 66, 193);">ondragstart</span> <span class="pl-k" style="box-sizing: border-box; color: rgb(215, 58, 73);">=</span> (<span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">event</span>) <span class="pl-k" style="box-sizing: border-box; color: rgb(215, 58, 73);">=&gt;</span> {</span>
<span class="pl-s1" style="box-sizing: border-box;">    <span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">event</span>.<span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">preventDefault</span>()</span>
<span class="pl-s1" style="box-sizing: border-box;">    <span class="pl-smi" style="box-sizing: border-box; color: rgb(36, 41, 46);">ipcRenderer</span>.<span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">send</span>(<span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span>ondragstart<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span></span>, <span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span>/path/to/item<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span></span>)</span>
<span class="pl-s1" style="box-sizing: border-box;">  }</span>
<span class="pl-s1" style="box-sizing: border-box;"></span><span class="pl-s1" style="box-sizing: border-box;">&lt;</span>/<span class="pl-ent" style="box-sizing: border-box; color: rgb(34, 134, 58);">script</span>&gt;</pre></div><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">然后, 在主进程中，接收拖拽过来的文件路径和在拖拽过程中要显示的图标。</p><div class="highlight highlight-source-js" style="box-sizing: border-box; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; word-wrap: normal; padding: 16px; overflow: auto; line-height: 1.45; background-color: rgb(246, 248, 250); border-radius: 3px; word-break: normal;"><span class="pl-k" style="box-sizing: border-box; color: rgb(215, 58, 73);">const</span> { <span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">ipcMain</span> } <span class="pl-k" style="box-sizing: border-box; color: rgb(215, 58, 73);">=</span> <span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">require</span>(<span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span>electron<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span></span>)

<span class="pl-smi" style="box-sizing: border-box; color: rgb(36, 41, 46);">ipcMain</span>.<span class="pl-en" style="box-sizing: border-box; color: rgb(111, 66, 193);">on</span>(<span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span>ondragstart<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span></span>, (<span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">event</span>, <span class="pl-smi" style="box-sizing: border-box; color: rgb(36, 41, 46);">filePath</span>) <span class="pl-k" style="box-sizing: border-box; color: rgb(215, 58, 73);">=&gt;</span> {
  <span class="pl-c1" style="box-sizing: border-box; color: rgb(0, 92, 197);">event</span>.<span class="pl-smi" style="box-sizing: border-box; color: rgb(36, 41, 46);">sender</span>.<span class="pl-en" style="box-sizing: border-box; color: rgb(111, 66, 193);">startDrag</span>({
    file<span class="pl-k" style="box-sizing: border-box; color: rgb(215, 58, 73);">:</span> filePath,
    icon<span class="pl-k" style="box-sizing: border-box; color: rgb(215, 58, 73);">:</span> <span class="pl-s" style="box-sizing: border-box; color: rgb(3, 47, 98);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span>/path/to/icon.png<span class="pl-pds" style="box-sizing: border-box; color: rgb(3, 47, 98);">'</span></span>
  })
})</pre></div><!--EndFragment-->

</body></html>