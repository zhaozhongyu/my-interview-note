<html><head></head>
<body><!--StartFragment--><h1 id="mutation" style="font-weight: 600; line-height: 1.25; font-size: 2.2rem; margin-top: -1.5rem; padding-top: 4.6rem; margin-bottom: 1rem; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Mutation</h1><p style="line-height: 1.7; margin-top: 2rem; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。Vuex 中的 mutation 非常类似于事件：每个 mutation 都有一个字符串的<span>&nbsp;</span><strong style="font-weight: 600;">事件类型 (type)</strong><span>&nbsp;</span>和 一个<span>&nbsp;</span><strong style="font-weight: 600;">回调函数 (handler)</strong>。这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token keyword" style="color: rgb(204, 153, 205);">const</span> store <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token keyword" style="color: rgb(204, 153, 205);">new</span> <span class="token class-name" style="color: rgb(248, 197, 85);">Vuex<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>Store</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  state<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    count<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token number" style="color: rgb(240, 141, 73);">1</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
  mutations<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token function" style="color: rgb(240, 141, 73);">increment</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      <span class="token comment" style="color: rgb(153, 153, 153);">// 变更状态</span>
      state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>count<span class="token operator" style="color: rgb(103, 205, 204);">++</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">你不能直接调用一个 mutation handler。这个选项更像是事件注册：“当触发一个类型为<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">increment</code><span>&nbsp;</span>的 mutation 时，调用此函数。”要唤醒一个 mutation handler，你需要以相应的 type 调用<span>&nbsp;</span><strong style="font-weight: 600;">store.commit</strong><span>&nbsp;</span>方法：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">store<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><h3 id="提交载荷（payload）" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/mutations.html#%E6%8F%90%E4%BA%A4%E8%BD%BD%E8%8D%B7%EF%BC%88payload%EF%BC%89" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>提交载荷（Payload）</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">你可以向<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store.commit</code><span>&nbsp;</span>传入额外的参数，即 mutation 的<span>&nbsp;</span><strong style="font-weight: 600;">载荷（payload）</strong>：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token comment" style="color: rgb(153, 153, 153);">// ...</span>
mutations<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token function" style="color: rgb(240, 141, 73);">increment</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> n<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>count <span class="token operator" style="color: rgb(103, 205, 204);">+=</span> n
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">store<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token number" style="color: rgb(240, 141, 73);">10</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">在大多数情况下，载荷应该是一个对象，这样可以包含多个字段并且记录的 mutation 会更易读：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token comment" style="color: rgb(153, 153, 153);">// ...</span>
mutations<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token function" style="color: rgb(240, 141, 73);">increment</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> payload<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>count <span class="token operator" style="color: rgb(103, 205, 204);">+=</span> payload<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>amount
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">store<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  amount<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token number" style="color: rgb(240, 141, 73);">10</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><h3 id="对象风格的提交方式" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/mutations.html#%E5%AF%B9%E8%B1%A1%E9%A3%8E%E6%A0%BC%E7%9A%84%E6%8F%90%E4%BA%A4%E6%96%B9%E5%BC%8F" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>对象风格的提交方式</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">提交 mutation 的另一种方式是直接使用包含<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">type</code><span>&nbsp;</span>属性的对象：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">store<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  type<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
  amount<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token number" style="color: rgb(240, 141, 73);">10</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">当使用对象风格的提交方式，整个对象都作为载荷传给 mutation 函数，因此 handler 保持不变：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">mutations<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token function" style="color: rgb(240, 141, 73);">increment</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> payload<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>count <span class="token operator" style="color: rgb(103, 205, 204);">+=</span> payload<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>amount
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><h3 id="mutation-需遵守-vue-的响应规则" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/mutations.html#mutation-%E9%9C%80%E9%81%B5%E5%AE%88-vue-%E7%9A%84%E5%93%8D%E5%BA%94%E8%A7%84%E5%88%99" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>Mutation 需遵守 Vue 的响应规则</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">既然 Vuex 的 store 中的状态是响应式的，那么当我们变更状态时，监视状态的 Vue 组件也会自动更新。这也意味着 Vuex 中的 mutation 也需要与使用 Vue 一样遵守一些注意事项：</p><ol style="padding-left: 1.2em; line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><li><p style="line-height: 1.7;">最好提前在你的 store 中初始化好所有所需属性。</p></li><li><p style="line-height: 1.7;">当需要在对象上添加新属性时，你应该</p></li></ol><ul style="padding-left: 1.2em; line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><li><p style="line-height: 1.7;">使用<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">Vue.set(obj, 'newProp', 123)</code>, 或者</p></li><li><p style="line-height: 1.7;">以新对象替换老对象。例如，利用 stage-3 的<a href="https://github.com/sebmarkbage/ecmascript-rest-spread" target="_blank" rel="noopener noreferrer" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124);">对象展开运算符<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>我们可以这样写：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>obj <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> <span class="token operator" style="color: rgb(103, 205, 204);">...</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>obj<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> newProp<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token number" style="color: rgb(240, 141, 73);">123</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div></li></ul><h3 id="使用常量替代-mutation-事件类型" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/mutations.html#%E4%BD%BF%E7%94%A8%E5%B8%B8%E9%87%8F%E6%9B%BF%E4%BB%A3-mutation-%E4%BA%8B%E4%BB%B6%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>使用常量替代 Mutation 事件类型</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">使用常量替代 mutation 事件类型在各种 Flux 实现中是很常见的模式。这样可以使 linter 之类的工具发挥作用，同时把这些常量放在单独的文件中可以让你的代码合作者对整个 app 包含的 mutation 一目了然：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token comment" style="color: rgb(153, 153, 153);">// mutation-types.js</span>
<span class="token keyword" style="color: rgb(204, 153, 205);">export</span> <span class="token keyword" style="color: rgb(204, 153, 205);">const</span> <span class="token constant" style="color: rgb(248, 197, 85);">SOME_MUTATION</span> <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token string" style="color: rgb(126, 198, 153);">'SOME_MUTATION'</span>
</code></pre></div><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token comment" style="color: rgb(153, 153, 153);">// store.js</span>
<span class="token keyword" style="color: rgb(204, 153, 205);">import</span> Vuex <span class="token keyword" style="color: rgb(204, 153, 205);">from</span> <span class="token string" style="color: rgb(126, 198, 153);">'vuex'</span>
<span class="token keyword" style="color: rgb(204, 153, 205);">import</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> <span class="token constant" style="color: rgb(248, 197, 85);">SOME_MUTATION</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span> <span class="token keyword" style="color: rgb(204, 153, 205);">from</span> <span class="token string" style="color: rgb(126, 198, 153);">'./mutation-types'</span>

<span class="token keyword" style="color: rgb(204, 153, 205);">const</span> store <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token keyword" style="color: rgb(204, 153, 205);">new</span> <span class="token class-name" style="color: rgb(248, 197, 85);">Vuex<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>Store</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  state<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> <span class="token operator" style="color: rgb(103, 205, 204);">...</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
  mutations<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token comment" style="color: rgb(153, 153, 153);">// 我们可以使用 ES2015 风格的计算属性命名功能来使用一个常量作为函数名</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">[</span><span class="token constant" style="color: rgb(248, 197, 85);">SOME_MUTATION</span><span class="token punctuation" style="color: rgb(204, 204, 204);">]</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      <span class="token comment" style="color: rgb(153, 153, 153);">// mutate state</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">用不用常量取决于你——在需要多人协作的大型项目中，这会很有帮助。但如果你不喜欢，你完全可以不这样做。</p><h3 id="mutation-必须是同步函数" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/mutations.html#mutation-%E5%BF%85%E9%A1%BB%E6%98%AF%E5%90%8C%E6%AD%A5%E5%87%BD%E6%95%B0" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>Mutation 必须是同步函数</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">一条重要的原则就是要记住<span>&nbsp;</span><strong style="font-weight: 600;">mutation 必须是同步函数</strong>。为什么？请参考下面的例子：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">mutations<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token function" style="color: rgb(240, 141, 73);">someMutation</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    api<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">callAsyncMethod</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token operator" style="color: rgb(103, 205, 204);">=&gt;</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>count<span class="token operator" style="color: rgb(103, 205, 204);">++</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">现在想象，我们正在 debug 一个 app 并且观察 devtool 中的 mutation 日志。每一条 mutation 被记录，devtools 都需要捕捉到前一状态和后一状态的快照。然而，在上面的例子中 mutation 中的异步函数中的回调让这不可能完成：因为当 mutation 触发的时候，回调函数还没有被调用，devtools 不知道什么时候回调函数实际上被调用——实质上任何在回调函数中进行的状态的改变都是不可追踪的。</p><h3 id="在组件中提交-mutation" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/mutations.html#%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%AD%E6%8F%90%E4%BA%A4-mutation" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>在组件中提交 Mutation</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">你可以在组件中使用<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">this.$store.commit('xxx')</code><span>&nbsp;</span>提交 mutation，或者使用<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">mapMutations</code><span>&nbsp;</span>辅助函数将组件中的 methods 映射为<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store.commit</code><span>&nbsp;</span>调用（需要在根节点注入<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store</code>）。</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token keyword" style="color: rgb(204, 153, 205);">import</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> mapMutations <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span> <span class="token keyword" style="color: rgb(204, 153, 205);">from</span> <span class="token string" style="color: rgb(126, 198, 153);">'vuex'</span>

<span class="token keyword" style="color: rgb(204, 153, 205);">export</span> <span class="token keyword" style="color: rgb(204, 153, 205);">default</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token comment" style="color: rgb(153, 153, 153);">// ...</span>
  methods<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token operator" style="color: rgb(103, 205, 204);">...</span><span class="token function" style="color: rgb(240, 141, 73);">mapMutations</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">[</span>
      <span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token comment" style="color: rgb(153, 153, 153);">// 将 `this.increment()` 映射为 `this.$store.commit('increment')`</span>

      <span class="token comment" style="color: rgb(153, 153, 153);">// `mapMutations` 也支持载荷：</span>
      <span class="token string" style="color: rgb(126, 198, 153);">'incrementBy'</span> <span class="token comment" style="color: rgb(153, 153, 153);">// 将 `this.incrementBy(amount)` 映射为 `this.$store.commit('incrementBy', amount)`</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">]</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
    <span class="token operator" style="color: rgb(103, 205, 204);">...</span><span class="token function" style="color: rgb(240, 141, 73);">mapMutations</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      add<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token string" style="color: rgb(126, 198, 153);">'increment'</span> <span class="token comment" style="color: rgb(153, 153, 153);">// 将 `this.add()` 映射为 `this.$store.commit('increment')`</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span></code></pre></div><!--EndFragment-->

</body></html>