<html><head></head>
<body><!--StartFragment--><h1 id="action" style="font-weight: 600; line-height: 1.25; font-size: 2.2rem; margin-top: -1.5rem; padding-top: 4.6rem; margin-bottom: 1rem; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Action</h1><p style="line-height: 1.7; margin-top: 2rem; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Action 类似于 mutation，不同在于：</p><ul style="padding-left: 1.2em; line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><li>Action 提交的是 mutation，而不是直接变更状态。</li><li>Action 可以包含任意异步操作。</li></ul><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">让我们来注册一个简单的 action：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token keyword" style="color: rgb(204, 153, 205);">const</span> store <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token keyword" style="color: rgb(204, 153, 205);">new</span> <span class="token class-name" style="color: rgb(248, 197, 85);">Vuex<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>Store</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  state<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    count<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token number" style="color: rgb(240, 141, 73);">0</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
  mutations<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token function" style="color: rgb(240, 141, 73);">increment</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>count<span class="token operator" style="color: rgb(103, 205, 204);">++</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
  actions<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token function" style="color: rgb(240, 141, 73);">increment</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>context<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      context<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Action 函数接受一个与 store 实例具有相同方法和属性的 context 对象，因此你可以调用<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">context.commit</code><span>&nbsp;</span>提交一个 mutation，或者通过<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">context.state</code><span>&nbsp;</span>和<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">context.getters</code><span>&nbsp;</span>来获取 state 和 getters。当我们在之后介绍到<span>&nbsp;</span><a href="https://vuex.vuejs.org/zh/guide/modules.html" class="" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124);">Modules</a><span>&nbsp;</span>时，你就知道 context 对象为什么不是 store 实例本身了。</p><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">实践中，我们会经常用到 ES2015 的<span>&nbsp;</span><a href="https://github.com/lukehoban/es6features#destructuring" target="_blank" rel="noopener noreferrer" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124);">参数解构<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span>&nbsp;</span>来简化代码（特别是我们需要调用<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">commit</code><span>&nbsp;</span>很多次的时候）：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">actions<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token function" style="color: rgb(240, 141, 73);">increment</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> commit <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><h3 id="分发-action" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/actions.html#%E5%88%86%E5%8F%91-action" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>分发 Action</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Action 通过<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store.dispatch</code><span>&nbsp;</span>方法触发：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">store<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">dispatch</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">乍一眼看上去感觉多此一举，我们直接分发 mutation 岂不更方便？实际上并非如此，还记得<span>&nbsp;</span><strong style="font-weight: 600;">mutation 必须同步执行</strong>这个限制么？Action 就不受约束！我们可以在 action 内部执行<strong style="font-weight: 600;">异步</strong>操作：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">actions<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token function" style="color: rgb(240, 141, 73);">incrementAsync</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> commit <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token function" style="color: rgb(240, 141, 73);">setTimeout</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token operator" style="color: rgb(103, 205, 204);">=&gt;</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token number" style="color: rgb(240, 141, 73);">1000</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Actions 支持同样的载荷方式和对象方式进行分发：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token comment" style="color: rgb(153, 153, 153);">// 以载荷形式分发</span>
store<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">dispatch</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'incrementAsync'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  amount<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token number" style="color: rgb(240, 141, 73);">10</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>

<span class="token comment" style="color: rgb(153, 153, 153);">// 以对象形式分发</span>
store<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">dispatch</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  type<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token string" style="color: rgb(126, 198, 153);">'incrementAsync'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
  amount<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token number" style="color: rgb(240, 141, 73);">10</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">来看一个更加实际的购物车示例，涉及到<strong style="font-weight: 600;">调用异步 API</strong><span>&nbsp;</span>和<strong style="font-weight: 600;">分发多重 mutation</strong>：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">actions<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token function" style="color: rgb(240, 141, 73);">checkout</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> commit<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> state <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> products<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token comment" style="color: rgb(153, 153, 153);">// 把当前购物车的物品备份起来</span>
    <span class="token keyword" style="color: rgb(204, 153, 205);">const</span> savedCartItems <span class="token operator" style="color: rgb(103, 205, 204);">=</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">[</span><span class="token operator" style="color: rgb(103, 205, 204);">...</span>state<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>cart<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span>added<span class="token punctuation" style="color: rgb(204, 204, 204);">]</span>
    <span class="token comment" style="color: rgb(153, 153, 153);">// 发出结账请求，然后乐观地清空购物车</span>
    <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>types<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token constant" style="color: rgb(248, 197, 85);">CHECKOUT_REQUEST</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
    <span class="token comment" style="color: rgb(153, 153, 153);">// 购物 API 接受一个成功回调和一个失败回调</span>
    shop<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">buyProducts</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>
      products<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
      <span class="token comment" style="color: rgb(153, 153, 153);">// 成功操作</span>
      <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token operator" style="color: rgb(103, 205, 204);">=&gt;</span> <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>types<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token constant" style="color: rgb(248, 197, 85);">CHECKOUT_SUCCESS</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
      <span class="token comment" style="color: rgb(153, 153, 153);">// 失败操作</span>
      <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token operator" style="color: rgb(103, 205, 204);">=&gt;</span> <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>types<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token constant" style="color: rgb(248, 197, 85);">CHECKOUT_FAILURE</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> savedCartItems<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">注意我们正在进行一系列的异步操作，并且通过提交 mutation 来记录 action 产生的副作用（即状态变更）。</p><h3 id="在组件中分发-action" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/actions.html#%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%AD%E5%88%86%E5%8F%91-action" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>在组件中分发 Action</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">你在组件中使用<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">this.$store.dispatch('xxx')</code><span>&nbsp;</span>分发 action，或者使用<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">mapActions</code><span>&nbsp;</span>辅助函数将组件的 methods 映射为<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store.dispatch</code><span>&nbsp;</span>调用（需要先在根节点注入<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store</code>）：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token keyword" style="color: rgb(204, 153, 205);">import</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> mapActions <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span> <span class="token keyword" style="color: rgb(204, 153, 205);">from</span> <span class="token string" style="color: rgb(126, 198, 153);">'vuex'</span>

<span class="token keyword" style="color: rgb(204, 153, 205);">export</span> <span class="token keyword" style="color: rgb(204, 153, 205);">default</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token comment" style="color: rgb(153, 153, 153);">// ...</span>
  methods<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token operator" style="color: rgb(103, 205, 204);">...</span><span class="token function" style="color: rgb(240, 141, 73);">mapActions</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">[</span>
      <span class="token string" style="color: rgb(126, 198, 153);">'increment'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token comment" style="color: rgb(153, 153, 153);">// 将 `this.increment()` 映射为 `this.$store.dispatch('increment')`</span>

      <span class="token comment" style="color: rgb(153, 153, 153);">// `mapActions` 也支持载荷：</span>
      <span class="token string" style="color: rgb(126, 198, 153);">'incrementBy'</span> <span class="token comment" style="color: rgb(153, 153, 153);">// 将 `this.incrementBy(amount)` 映射为 `this.$store.dispatch('incrementBy', amount)`</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">]</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
    <span class="token operator" style="color: rgb(103, 205, 204);">...</span><span class="token function" style="color: rgb(240, 141, 73);">mapActions</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      add<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token string" style="color: rgb(126, 198, 153);">'increment'</span> <span class="token comment" style="color: rgb(153, 153, 153);">// 将 `this.add()` 映射为 `this.$store.dispatch('increment')`</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><h3 id="组合-action" style="font-weight: 600; line-height: 1.25; font-size: 1.35rem; margin-top: -3.1rem; padding-top: 4.6rem; margin-bottom: 0px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://vuex.vuejs.org/zh/guide/actions.html#%E7%BB%84%E5%90%88-action" aria-hidden="true" class="header-anchor" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124); font-size: 0.85em; float: left; margin-left: -0.87em; padding-right: 0.23em; margin-top: 0.125em; opacity: 0;">#</a>组合 Action</h3><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Action 通常是异步的，那么如何知道 action 什么时候结束呢？更重要的是，我们如何才能组合多个 action，以处理更加复杂的异步流程？</p><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">首先，你需要明白<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store.dispatch</code><span>&nbsp;</span>可以处理被触发的 action 的处理函数返回的 Promise，并且<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store.dispatch</code><span>&nbsp;</span>仍旧返回 Promise：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">actions<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token function" style="color: rgb(240, 141, 73);">actionA</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> commit <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token keyword" style="color: rgb(204, 153, 205);">return</span> <span class="token keyword" style="color: rgb(204, 153, 205);">new</span> <span class="token class-name" style="color: rgb(248, 197, 85);">Promise</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span>resolve<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> reject<span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token operator" style="color: rgb(103, 205, 204);">=&gt;</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      <span class="token function" style="color: rgb(240, 141, 73);">setTimeout</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token operator" style="color: rgb(103, 205, 204);">=&gt;</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
        <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'someMutation'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
        <span class="token function" style="color: rgb(240, 141, 73);">resolve</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
      <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token number" style="color: rgb(240, 141, 73);">1000</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">现在你可以：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">store<span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">dispatch</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'actionA'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span><span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">then</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token operator" style="color: rgb(103, 205, 204);">=&gt;</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token comment" style="color: rgb(153, 153, 153);">// ...</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">在另外一个 action 中也可以：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;">actions<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token comment" style="color: rgb(153, 153, 153);">// ...</span>
  <span class="token function" style="color: rgb(240, 141, 73);">actionB</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> dispatch<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> commit <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token keyword" style="color: rgb(204, 153, 205);">return</span> <span class="token function" style="color: rgb(240, 141, 73);">dispatch</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'actionA'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span><span class="token punctuation" style="color: rgb(204, 204, 204);">.</span><span class="token function" style="color: rgb(240, 141, 73);">then</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token operator" style="color: rgb(103, 205, 204);">=&gt;</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
      <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'someOtherMutation'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
    <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><p style="line-height: 1.7; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">最后，如果我们利用<span>&nbsp;</span><a href="https://tc39.github.io/ecmascript-asyncawait/" target="_blank" rel="noopener noreferrer" style="font-weight: 500; text-decoration: none; color: rgb(62, 175, 124);">async / await<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，我们可以如下组合 action：</p><div class="language-js extra-class" style="position: relative; background-color: rgb(40, 44, 52); border-radius: 6px; color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><pre class="language-js" style="color: rgb(204, 204, 204); background: transparent; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.4; tab-size: 4; hyphens: none; padding: 1.25rem 1.5rem; margin: 0.85rem 0px; overflow: auto; position: relative; z-index: 1;"><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(255, 255, 255); padding: 0px; margin: 0px; font-size: 0.85em; background-color: transparent; border-radius: 0px;"><span class="token comment" style="color: rgb(153, 153, 153);">// 假设 getData() 和 getOtherData() 返回的是 Promise</span>

actions<span class="token punctuation" style="color: rgb(204, 204, 204);">:</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
  <span class="token keyword" style="color: rgb(204, 153, 205);">async</span> <span class="token function" style="color: rgb(240, 141, 73);">actionA</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> commit <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'gotData'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token keyword" style="color: rgb(204, 153, 205);">await</span> <span class="token function" style="color: rgb(240, 141, 73);">getData</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span>
  <span class="token keyword" style="color: rgb(204, 153, 205);">async</span> <span class="token function" style="color: rgb(240, 141, 73);">actionB</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">{</span> dispatch<span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> commit <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token punctuation" style="color: rgb(204, 204, 204);">{</span>
    <span class="token keyword" style="color: rgb(204, 153, 205);">await</span> <span class="token function" style="color: rgb(240, 141, 73);">dispatch</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'actionA'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span> <span class="token comment" style="color: rgb(153, 153, 153);">// 等待 actionA 完成</span>
    <span class="token function" style="color: rgb(240, 141, 73);">commit</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token string" style="color: rgb(126, 198, 153);">'gotOtherData'</span><span class="token punctuation" style="color: rgb(204, 204, 204);">,</span> <span class="token keyword" style="color: rgb(204, 153, 205);">await</span> <span class="token function" style="color: rgb(240, 141, 73);">getOtherData</span><span class="token punctuation" style="color: rgb(204, 204, 204);">(</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span><span class="token punctuation" style="color: rgb(204, 204, 204);">)</span>
  <span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
<span class="token punctuation" style="color: rgb(204, 204, 204);">}</span>
</code></pre></div><blockquote style="font-size: 1.2rem; color: rgb(153, 153, 153); border-left: 0.25rem solid rgb(223, 226, 229); margin-left: 0px; padding-left: 1rem; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><p style="line-height: 1.7;">一个<span>&nbsp;</span><code style="font-family: source-code-pro, Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; color: rgb(71, 101, 130); padding: 0.25rem 0.5rem; margin: 0px; font-size: 0.85em; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px;">store.dispatch</code><span>&nbsp;</span>在不同模块中可以触发多个 action 函数。在这种情况下，只有当所有触发函数完成后，返回的 Promise 才会执行。</p></blockquote><!--EndFragment-->

</body></html>